<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>DICE App</title>
    <link rel="shortcut icon" type="image/x-icon" href="{{ url_for('static', filename='favicon.ico') }}">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <link href="https://fonts.googleapis.com/css2?family=Source+Serif+Pro:wght@400;600&display=swap" rel="stylesheet">
    <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
</head>
<body>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>
<script src="{{ url_for('static', filename='validation.js') }}"></script>
<script src="{{ url_for('static', filename='script.js') }}"></script>
<script src="{{ url_for('static', filename='smooth_scrolling.js') }}"></script>
<script src="{{ url_for('static', filename='citations.js') }}"></script>
<script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>
{#<script src="{{ url_for('static', filename='config_goals.js') }}"></script>#}

<nav class="navbar fixed-top border-bottom bg-white bg-opacity-75 border-opacity-50">
    <div class="container">
        <a class="navbar-brand" href="#">
            <img src="{{ url_for('static', filename='favicon.ico') }}" alt="Logo" width="30" height="30">
            &nbsp; &nbsp;DICE App
        </a>
        <!-- Add form for session code input
        <form class="d-flex" onsubmit="retrieveSessionData(event)">
          <input class="form-control me-2" type="search" placeholder="Enter session code" aria-label="Session code" id="sessionCodeInput">
          <button class="btn btn-outline-success" type="submit">Get Data</button>
        </form>
        -->
    </div>
</nav>

<div class="px-4 pt-5 mt-5 text-center border-bottom bg-white">
    <h1 class="display-3 fw-bold text-body-emphasis">DICE</h1>
    <div class="col-lg-6 mx-auto">
        <h3 class="mb-4" style="font-family: 'Source Serif Pro', serif; color: #404040;">
            Create Digital In-Context Experiments (DICE) to mimic social media feeds with experimental control and without a single line of code. Simply configure your stimuli, distribute them (e.g., via Prolific) and append a questionnaire.
        </h3>
        <div class="hero-buttons mb-5">
            <a class="btn btn-outline-secondary btn-lg px-4" href="https://ibt-hsg.herokuapp.com/demo" target="_blank" role="button">Demo</a>
            <button class="btn btn-outline-secondary btn-lg px-4" data-bs-toggle="modal" data-bs-target="#citationModal">Citation</button>
            <a class="btn btn-outline-secondary btn-lg px-4" href="/docs/index.html" target="_blank">Documentation</a>
            <a class="btn btn-danger btn-lg px-4" href="https://www.youtube.com/watch?v=lx_akVasq7I&list=PLZ-soW8YjcdezgGILvI4dmQU2lpl0cAC0" target="_blank"><i class="bi bi-play-fill"></i> Watch Tutorial</a>
            <button class="btn btn-outline-secondary btn-lg px-4" data-bs-toggle="modal" data-bs-target="#helpModal">Get Help</button>
        </div>
    </div>
    <div class="overflow-hidden" style="max-height: 70vh;">
        <div class="container">
            <img src="{{ url_for('static', filename='screenshot.webp') }}" class="img-fluid border-0 mb-4" alt="Example image" width="700" height="500">
        </div>
    </div>
</div>

<div id="configureStudySection" class="bg-body-tertiary overflow-hidden">
    <div class="container my-3 py-3">
        <div class="row justify-content-center">
            <div class="col-lg-8">
                {#<h2 class="display-5 mt-4 text-center">Configure a Study</h2>#}
                <h3 style="font-family: 'Source Serif Pro', serif; color: #404040;">
                    In just a few clicks, you can create and customize stimuli for your social media experiment.
                    No coding required.
                    The following form walks you through the process of creating your own DICE session.
                    {#To start, choose <code>Testing</code> if you are in the development phase and want to quickly create and test a set of stimuli, as this option will skip some of the detailed configuration steps.
                    Choose <code>Final Configuration</code> once you tested your stimuli and want to configure your final experiment.#}
                </h3>

                <!-- Database Reset Warning -->
                <div class="alert alert-dismissible fade show mt-5 mb-0" role="alert" style="background-color: rgba(220, 53, 69, 0.08); border-left: 4px solid #dc3545; border-right: none; border-top: none; border-bottom: none; padding: 1rem;">
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                    <div style="text-align: left;">
                        The database will be reset on Friday, November 28, 2025 at 12:00 PM CET. This will permanently delete all data.
                        <br><br>
                        <strong>Please ensure you:</strong>
                        <ul class="mb-0" style="margin-top: 0.5rem;">
                            <li>Download your data from the oTree admin interface before this date</li>
                            <li>Archive one feed link per condition using <a href="https://archive.org/web/" target="_blank" style="color: #721c24;">archive.org</a></li>
                            <li>Reach out if you have any questions or concerns</li>
                        </ul>
                    </div>
                </div>
                {#<div id="scrollPrompt" class="text-center">
                    <div class="text-muted mb-2">
                        Scroll to explore
                        <br>
                        <i class="bi bi-chevron-down"></i>
                    </div>
                </div>#}
                {#<div class="d-flex justify-content-center">
                    <div class="btn-group" role="group" aria-label="Basic radio toggle button group">
                        <input type="radio" class="btn-check" name="btnradio" id="btnradio1" autocomplete="off">
                        <label class="btn btn-outline-dark" for="btnradio1">Testing</label>

                        <input type="radio" class="btn-check" name="btnradio" id="btnradio2" autocomplete="off">
                        <label class="btn btn-outline-dark" for="btnradio2">Final Configuration</label>
                    </div>
                </div>#}
            </div>
        </div>
    </div>

    <div class= "container-md mb-5 mt-3">
        <div class= "row justify-content-center">
            <div class= "col-lg-8 col-md-10">

                <div class="card my-4 border-0 shadow bg-light">
                    <div class="card-body">
                        <h6 class="card-title text-muted mb-3">
                            Returning user? Upload Previous Configuration
                        </h6>
                        <p class="card-text text-muted mb-3">
                            <small>
                                Upload a previously downloaded configuration file (e.g., <code>abc123_dice_config.json</code>)
                                to automatically fill out the form with your previous settings.
                            </small>
                        </p>

                        <div class="row align-items-end">
                            <div class="col-md-8">
                                <label for="configFileInput" class="form-label">Choose Configuration File</label>
                                <input type="file" class="form-control" id="configFileInput" accept=".json" />
                            </div>
                            <div class="col-md-4 mt-4">
                                <button type="button" class="btn btn-outline-dark w-100" id="loadConfigBtn" onclick="loadConfigurationFile()" disabled>
                                    <i class="bi bi-folder-open"></i> Load Configuration
                                </button>
                            </div>
                        </div>

                        <!-- Success/error messages will appear here -->
                        <div id="configLoadMessage" class="mt-3" style="display: none;"></div>
                    </div>
                </div>

                <div id="card1" class="card my-4 border-0 shadow">
                    <div class="card-body">
                        <h5 class="card-title h2 mb-0">
                            1. Meta Information
                        </h5>
                        <p class="card-text text-muted">
                            <small>
                                Please provide some meta and contact information. The contact information will be displayed in the privacy policy and
                                on the final debriefing page if you do not direct the participants to a post-stimulus survey.
                            </small>
                        </p>
                        <form>
                            <div class="mb-3">
                                <label for="title" class="form-label">Title</label>
                                <select class="form-select" id="title" aria-describedby="title_help">
                                    <option value="Dr.">Dr.</option>
                                    <option value="Prof.">Prof.</option>
                                    <option value="Ms.">Ms.</option>
                                    <option value="Mr.">Mr.</option>
                                </select>
                                <div id="title_help" class="form-text">
                                </div>
                            </div>
                            <div class="mb-3">
                                <label for="name" class="form-label">Name</label>
                                <input type="text" class="form-control" id="name" aria-describedby="name_help" value="" placeholder="Jane Doe" required>
                                <div id="name_help" class="form-text">
                                </div>
                            </div>
                            <div class="mb-3">
                                <label for="eMail" class="form-label">Email address</label>
                                <input type="email" class="form-control" id="eMail" placeholder="name@example.com" required>
                            </div>

                            <div class="mb-3">
                                <label for="external_name" class="form-label">External study name</label>
                                <input type="text" class="form-control" id="external_name" value="" placeholder="A Social Media Study" required>
                            </div>
                            <div class="mb-3">
                                <label for="internal_name" class="form-label">Internal study name (not visible to participants)</label>
                                <input type="text" class="form-control" id="internal_name" value="" placeholder="Social Media Study Pilot" required>
                            </div>
                        </form>
                    </div>
                </div>

                <div id="card2" class="card my-4 border-0 shadow">
                    <div class="card-body">
                        <h5 class="card-title h2 mb-0">
                            2. Participant Recruitment
                        </h5>
                        <p class="card-text text-muted">
                            <small>
                                Configure where your participants come from and how many can access your study.
                            </small>
                        </p>
                        <form>
                            <div class="mb-3">
                                <label for="recruitment_platform" class="form-label">Study Type</label>
                                <select class="form-select" id="recruitment_platform" aria-describedby="recruitment_help">
                                    <optgroup label="Online Recruitment Platforms">
                                        <option value="Prolific" selected>Prolific</option>
                                        <option value="Connect">Connect (Cloud Research)</option>
                                    </optgroup>
                                    <optgroup label="Lab Studies">
                                        <option value="Lab">Lab Study (Single-Use Links)</option>
                                    </optgroup>
                                </select>
                                <div id="recruitment_help" class="form-text">
                                    Select whether you're recruiting online (Prolific/Connect) or running a lab study with single-use participant links.
                                </div>
                            </div>
                            <div class="mb-3">
                                <label for="participant_number" class="form-label">Study Slots</label>
                                <input type="number" class="form-control w-100" id="participant_number" aria-describedby="participant_help" value="3" min="1" max="400">
                                <div id="participant_help" class="form-text">
                                    How many participants can <em>start</em> your study (maximum 400).
                                    <strong>Note:</strong> If you're just testing and playing around, please keep your sessions small to avoid unnecessary database strain.
                                    <strong>Remember:</strong> Some participants may not complete the study, so allocate extra slots to account for dropouts.
                                    Once this limit is reached, no new participants can join.
                                    <br> Please get in touch if you intend to run larger studies.
                                </div>
                            </div>
                            <!-- Hidden field for platform preset logic -->
                            <input type="text" class="d-none" id="url_parameter_name" value="PROLIFIC_PID">
                        </form>
                    </div>
                </div>

                <div id="card3" class="card my-4 border-0 shadow">
                    <div class="card-body">
                        <h5 class="card-title h2 mb-0">
                            3. Layout and Stimulus Embedding
                        </h5>
                        <p class="card-text text-muted">
                            <small>
                                Please use the following forms to specify the content you want to display in the social media feed and
                                the way it is displayed.
                            </small>
                        </p>
                        <form>
                            <div class="mb-3">
                                <label for="channel_type" class="form-label">Choose Media Platform to Mimic</label>
                                <select class="form-select" id="channel_type" aria-describedby="title_help">
                                    <option value="Twitter">Twitter</option>
                                    <option value="Linkedin">WIP: Linkedin</option>
                                    <option value="Generic">WIP: Generic</option>
                                    <!-- <option value="Mass_Media">Mass Media</option>-->
                                </select>
                            </div>
                            <div class="mb-3">
                                <label for="search_term" class="form-label">Provide a Term Displayed in Search Bar</label>
                                <input type="text" class="form-control" id="search_term" aria-describedby="search_help" value="#myHashtag">
                                <div id="search_help" class="form-text">
                                    Consider using a hashtag as a prefix.
                                </div>
                            </div>
                            <div class="mb-3">
                                <label for="content_url" class="form-label">Provide URL Directing to Your Content</label>
                                <input type="text" class="form-control" id="content_url" aria-describedby="url_help" value="https://raw.githubusercontent.com/DICE-app/sample-feeds/refs/heads/main/feeds/9gag.csv">
                                <div id="url_help" class="form-text">
                                    Please provide an url directing to your raw, UTF-8 formatted csv file (preferably GitHub or Google Drive).
                                    <a href="{{ url_for('static', filename='sample_feed.csv') }}" download="sample_feed.csv">Click here</a>
                                    to download a sample *.csv file that you can use as a template.
                                </div>
                            </div>
                            <div class="mb-3">
                                <label for="delimiter" class="form-label">Column Separator <span class="badge bg-secondary" data-delimiter-badge style="opacity: 0; transition: opacity 0.3s;">Auto-Detected</span></label>
                                <select class="form-select" id="delimiter" aria-describedby="delimiter_help">
                                    <option value=";">Semicolon (;)</option>
                                    <option value=",">Comma (,)</option>
                                    <option value="|">Pipe (|)</option>
                                </select>
                                <div id="delimiter_help" class="form-text">
                                    We automatically detect how your columns are separated. If the detected separator looks wrong, you can change it manually.
                                </div>
                            </div>
                            <div class="mb-3">
                                <div class="button-group">
                                    <button class="btn btn-success" type="button" onclick="testCSV()"
                                            data-bs-toggle="tooltip" data-bs-placement="top"
                                            title="Check your CSV structure, column count, and separator before creating your session">
                                        <i class="bi bi-check-circle"></i> Test CSV
                                    </button>
                                    <button class="btn btn-secondary" type="button" id="previewFeedBtn" onclick="previewFeed()"
                                            data-bs-toggle="tooltip" data-bs-placement="top"
                                            title="See how your stimuli will look in the social media feed"
                                            disabled>
                                        <i class="bi bi-eye"></i> Preview Feed
                                    </button>
                                </div>
                                <small class="form-text text-muted mt-2 d-block">Click to verify your CSV file before proceeding.</small>
                            </div>
                            <div id="csv-preview-container" class="csv-preview-container"></div>

                            <div class="form-check form-switch" style="display: none">
                                <input class="form-check-input" type="checkbox" role="switch" id="display_skyscraper" disabled>
                                <label class="form-check-label" for="display_skyscraper">Display  Skyskraper Banner Ads</label>
                            </div>
                        </form>
                    </div>
                </div>

                {#<div id="card4" class="card my-4 border-0 shadow">
                <div class="card-body">
                    <h5 class="card-title h2 mb-0">
                        4. Experimental Control
                    </h5>
                    <p class="card-text text-muted">
                        <small>
                            Please read the following instructions on how to define conditions participants will be randomly assigned to.
                        </small>
                    </p>
                    <h6 class="mb-0">
                        Conditions
                    </h6>
                    <p class="text-secondary">
                        The data you provide must contain a column called <code>condition</code>.
                        This column can take one or as many values as you need.
                        Participants will be randomly assigned to one of the values (that represent conditions) in that column.
                    </p>

                    <h6 class="mb-0">
                        Sequence
                    </h6>
                    <p class="text-secondary">
                        The data must also contain a column called <code>sequence</code>.
                        This columns specifies the order in which the posts are displayed.
                        Provide unique numeric value per row if you want to control the order. The post associated to the lowest number will
                        be displayed on top of the feed, the post associated to the highest number will be displayed
                        at the bottom. If two or more rows contain missing values, their order will be randomized.
                        You can provide both a condition and a sorting variable to mimic different recommender- and
                        sorting algorithms.
                    </p>
                </div>
            </div>#}

                <div id="card5" class="card my-4 border-0 shadow">
                    <div class="card-body">
                        <h5 class="card-title h2 mb-0">
                            4. Participant Briefing
                        </h5>
                        <p class="card-text text-muted">
                            <small>
                                Please use the following two editors to specify (1) the consent form that participants must agree to before participating in your study
                                as well as (2) the study instructions participants read prior to the feed exposure.
                            </small>
                        </p>

                        <div id="editor-container-consent" class="mb-4">
                            <div id="quill-editor-consent">
                                <h2>Consent Form</h2>
                                <p>
                                    Within the scope of the study, great importance is attached to compliance with data protection regulations,
                                    the protection of privacy and the confidentiality of the data. We strictly adhere to
                                    all applicable laws and regulations on data protection. With these notes we inform you
                                    about the processing of your personal data and the rights to which you are entitled.
                                    <br><br>
                                </p>

                                <h5>Investigator</h5>
                                <a style="background-color: black; color: white;">[Enter your contact information such as your name and your email address here.]</a>
                                <br><br>

                                <h5>Confidentiality</h5>
                                <p>
                                    The data collected in this study will be confidential. No personally identifiable information will be
                                    collected unless voluntarily provided. Any reports and presentations about the findings from this study
                                    will not include any information that could identify you. Eventually, results of the analyses may be
                                    published on an aggregate level in an academic journal. We may share the data we collect in this study
                                    with other researchers doing future studies – if we share your data, we will not include information
                                    that could identify you.
                                </p>
                                <br><br>

                                <h5>Withdrawal from the participation or the consent</h5>
                                <p>
                                    The participation in this research project is voluntary. You have at all times the right to withdraw
                                    from participating in the research project, without having to state the reason. You also have the right
                                    to withdraw your consent which will result in your personal information being removed so that it
                                    cannot be linked to you anymore. However, if you decide to discontinue your participation you will not
                                    be remunerated.
                                </p>
                                <br><br>

                                <h5>Individual Rights</h5>
                                <p>
                                    You are entitled to ask questions about this project at any time by contacting the above-mentioned
                                    investigator by e-mail.

                                    You have the right to access and require a copy of your personal data, object to the processing of your
                                    personal data, have them rectified or deleted. You also have a right to limit the processing of your
                                    data. You can exercise these rights by contacting the investigator.
                                </p>
                                <br><br>

                                <h5>
                                    By agreeing to these terms you consent to the following statement:
                                </h5>
                                <blockquote>
                                    <em>
                                        "I am 18 years of age or older, I consent/agree to participate in this study, I have read the
                                        information that explains the use of my data in this research, I understand its contents and agree to
                                        donate my data for the use of this research, and I will not have any financial benefits that result from
                                        the commercial development of this research.”
                                    </em>
                                </blockquote>

                            </div>
                        </div>

                        <div id="editor-container-briefing">
                            <div id="quill-editor-briefing">
                                <h2>Study Instructions</h2>
                                <p>You will be shown a social media feed. Please <u>browse</u> through the content naturally.</p>
                                <p>Take your time to read the posts that you find interesting.</p>
                            </div>
                        </div>
                        <p class="card-text text-muted">
                            <small>
                                Note: The whole briefing page is skipped if you leave this field empty.
                            </small>
                        </p>

                    </div>
                </div>

                <div id="card6" class="card my-4 border-0 shadow">
                    <div class="card-body">
                        <h5 class="card-title h2 mb-0">
                            5. Measurement
                        </h5>
                        <p class="card-text text-muted">
                            <small>
                                Plese use the following forms to define what you measure and how you measure it.
                            </small>
                        </p>
                        <form>
                            <div class="mb-3">
                                <label for="survey_url" class="form-label">Insert Your Survey's URL</label>
                                <input type="text" class="form-control" id="survey_url" aria-describedby="survey_url_help">
                                <div id="survey_url_help" class="form-text">
                                    Configure this  field, if you want to append a survey to the stimulus.
                                    We'll create a redirect with url parameters to pass both the participant ID as well as
                                    the completion code (for Prolific). Make sure that your survey tool accepts them
                                    (see <a href="https://researcher-help.prolific.com/hc/en-gb/articles/360009224113-Qualtrics-integration-guide" target="_blank">embedded data documentation</a>
                                    if you are using Qualtrics).Please provide a url directing to your survey. Please don't add any manual url parameters.
                                    If you leave this field empty, the study will close with an end of survey screen that provides
                                    your contact information provided above.
                                </div>
                            </div>
                            <label for="dwell_threshold" class="form-label">Dwell Time Tracking Threshold</label>
                            <div class="input-group mb-3">
                                <span class="input-group-text">%</span>
                                <input type="number" class="form-control" id="dwell_threshold" value="75" min="1" max="100">
                                <div id="dwell_threshold_help" class="form-text">
                                    This setting determines the visibility threshold for tracking dwell time.
                                    It represents the percentage of a social media post that must be visible to the participant before it's considered "in view".
                                    A lower value (closer to 1%) will track social media posts as soon as they're barely visible,
                                    whereas a higher value (closer to 100%) will only track rows when they're almost fully visible.
                                </div>
                            </div>
                        </form>
                    </div>
                </div>

                <div class="card my-4 border-0 shadow" id="adCard" style="display: none;">
                    <div class="card-body">
                        <h5 class="card-title h2 mb-0">
                            Skyscraper Banner Ad
                        </h5>
                        <p class="card-text text-muted">
                            <small>
                            </small>
                        </p>
                    </div>
                </div>

                <button id="createSessionBtn" type="button" class="btn btn-primary" style="display: none;">Create Session</button>

                <div id="alertPlaceholder"></div>

                <!-- Completion Code Section -->
                <div id="completionCodeSection" class="card my-4 border-0 shadow" style="display: none;">
                    <div class="card-body">
                        <h5 class="card-title h2 mb-0">
                            6. Completion Code
                        </h5>
                        <p class="card-text text-muted">
                            <small>
                                Please enter the completion code if you have selected Prolific as your recruitment platform.
                            </small>
                        </p>
                        <form id="completionCodeForm">
                            <div class="mb-3">
                                <label for="completionCode" class="form-label">Completion Code</label>
                                <input type="text" class="form-control" id="completionCode" placeholder="Enter Completion Code">
                            </div>
                            <button type="button" class="btn btn-primary" onclick="submitCompletionCode();">Submit Code</button>
                        </form>
                    </div>
                </div>

                <div id="completionAlertPlaceholder"></div>

            </div>
        </div>
    </div>
</div>

<!--
<div id="dataSection" class= "text-bg-primary text-center overflow-hidden">
    <div class="container my-3 py-3">
        <div class="row justify-content-center">
            <div class="col-lg-8">
                <h2 class="display-5 mt-4 text-center">Data </h2>
                <p class= "lead">Use our
                    <a class="text-white" href="https://roggenkamp.shinyapps.io/DICE-Preprocessing/" target="_blank">oTree</a>
                    Shiny App to process your data and get the most out of DICE, code-free!
                </p>
            </div>
        </div>
    </div>
</div>

<div id="contributeSection" class="bg-body-tertiary overflow-hidden">
    <div class="container my-3 py-3">
        <div class="row justify-content-center">
            <div class="col-lg-8">
                <h2 class="display-5 mt-4 text-center">Contribute </h2>
                <p class="lead text-center">
                    To foster collaborative development, we intentionally made DICE open-source and chose to use widely used frameworks such as the Python-based
                    <a href="https://www.otree.org/" target="_blank">oTree</a>,
                    <a href="https://flask.palletsprojects.com/en/3.0.x/" target="_blank">Flask</a>, and
                    <a href="https://getbootstrap.com/docs/5.2/getting-started/introduction/" target="_blank">Bootstrap</a>
                    as DICE's foundation to invite researchers to contribute to and, ultimately, enhance DICE.
                </p>
            </div>
        </div>

        <div class="row justify-content-center mt-4">
            <div class="col-lg-8">
                <div class="card-group">

                    <div class="card mb-3 me-2 border-0 shadow rounded-3">
                        <div class="card-body">
                            <p class="lead text-center">Your Contributions Matter</p>
                            <p class="card-text text-center">
                                Whether you're contributing code, participating in problem-solving, or sharing your research findings, your contributions are pivotal.
                                With each shared idea or line of code, you help refine DICE's functionality and user experience.
                            </p>
                        </div>
                    </div>

                    <div class="card mb-3 ms-2 border-0 shadow rounded-3">
                        <div class="card-body">
                            <p class="lead text-center">Ways to contribute:</p>
                            <p class="">
                                Code Development<br>
                                <small>Enhance the DICE with your Python skills or help us create additional user interfaces with Bootstrap.</small><br><br>
                                Suggestions<br>
                                <small>Have an idea for a new feature? We welcome your proposals to help make DICE more versatile and user-friendly.</small><br><br>
                                Issue Reporting<br>
                                <small>Encounter a glitch? Let us know. Your reports help us maintain a seamless experience for researchers and study participants.</small>
                            </p>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>
</div>
-->

<footer class="bg-light text-lg-start mt-4">
    <div class="row justify-content-end p-3 text-secondary bg-light border-top border-opacity-50 bg-opacity-25">
        <div class="col-lg-4 col-md-5 col-sm-6 mb-3 pe-5 pt-3">
            <a class="navbar-brand" href="#">
                <img src="{{ url_for('static', filename='favicon.ico') }}" alt="Logo" width="30" height="30">
                &nbsp; &nbsp;DICE App
            </a>
            <ul class="list-unstyled small text-muted mt-3">
                <li class="mb-2">
                    Like this work? <a href="https://ko-fi.com/howquez" target="_blank" rel="noopener" class="text-secondary">
                        Say thanks
                    </a>
                </li>
                <li class="mb-2">Designed with Bootstrap. Built for oTree.</li>
                <li class="mb-2">
                    <a class="text-secondary" href="https://github.com/Howquez/DICE/tree/main">DICE</a> © 2025 is licensed under
                    <a class="text-secondary" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="license noopener">
                        Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International
                    </a>
                    <img src="https://mirrors.creativecommons.org/presskit/icons/cc.svg" alt="CC" style="max-width: 1em;max-height:1em;margin-left: .2em;">
                    <img src="https://mirrors.creativecommons.org/presskit/icons/by.svg" alt="BY" style="max-width: 1em;max-height:1em;margin-left: .2em;">
                    <img src="https://mirrors.creativecommons.org/presskit/icons/nc.svg" alt="NC" style="max-width: 1em;max-height:1em;margin-left: .2em;">
                    <img src="https://mirrors.creativecommons.org/presskit/icons/sa.svg" alt="SA" style="max-width: 1em;max-height:1em;margin-left: .2em;">
                </li>
                <li class="mb-2">
                    <strong>Citation:</strong> Roggenkamp, H., Boegershausen, J., & Hildebrand, C. (2025). EXPRESS: DICE: Advancing Social Media Research through Digital In-Context Experiments. Journal of Marketing, 00222429251371702.
                </li>
                <li class="mb-2">No web analytics implemented.</li>
                <li class="mb-2"><a class="text-secondary" href="{{ url_for('imprint') }}">Imprint</a></li>
            </ul>
        </div>
    </div>
</footer>

<div class="modal fade" id="sessionModal" tabindex="-1" aria-labelledby="sessionModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-fullscreen">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="sessionModalLabel">
                    <img src="{{ url_for('static', filename='favicon.ico') }}" alt="Logo" width="30" height="30">
                    DICE Session View
                </h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body p-0 position-relative">
                <!-- Add covering box -->
                <div class="position-absolute bg-white" style="height: 60px; width: 100%; z-index: 1000;"></div>
                <iframe id="session-iframe" style="width: 100%; height: 100%; border: none;" title="Session View"></iframe>
            </div>
        </div>
    </div>
</div>

<!-- Citation Modal -->
<div class="modal fade" id="citationModal" tabindex="-1" aria-labelledby="citationModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-body">
                <p>
                    If you use DICE in your research, please cite this paper in addition to <a href="https://www.sciencedirect.com/science/article/pii/S2214635016000101" target="_blank">Chen et al. (2016)</a>:
                </p>

                <!-- Citation Format Selector -->
                <div class="mb-3">
                    <label for="citationFormat" class="form-label">Export Citation:</label>
                    <select class="form-select" id="citationFormat" onchange="updateCitation()">
                        <option value="bibtex">BibTeX</option>
                        <option value="apa">APA</option>
                        <option value="chicago">Chicago</option>
                        <option value="plaintext">Plain Text</option>
                        <option value="ris">RIS</option>
                    </select>
                </div>

                <!-- Citation Text Area -->
                <div class="mb-3">
                    <textarea class="form-control font-monospace" id="citationText" rows="8" readonly></textarea>
                </div>

                <!-- Action Buttons -->
                <div class="d-flex gap-2 mb-0">
                    <button class="btn btn-primary" onclick="copyCitation()">
                        <i class="bi bi-clipboard"></i> Copy
                    </button>
                    <button class="btn btn-outline-primary" onclick="downloadCitation()">
                        <i class="bi bi-download"></i> Download
                    </button>
                    <a class="btn btn-outline-secondary ms-auto" href="https://journals.sagepub.com/doi/10.1177/00222429251371702" target="_blank">
                        <i class="bi bi-box-arrow-up-right"></i> View Paper
                    </a>
                </div>

                <!-- Copy Success Message -->
                <div id="copySuccess" class="alert alert-success" style="display: none;" role="alert">
                    <i class="bi bi-check-circle"></i> Citation copied to clipboard!
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Help Modal -->
<div class="modal fade" id="helpModal" tabindex="-1" aria-labelledby="helpModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-body">

                <!-- Primary: GitHub Discussions -->
                <div class="card border-primary mb-3">
                    <div class="card-header bg-primary text-white">
                        <i class="bi bi-chat-dots"></i> <strong>Recommended: Community Forum</strong>
                    </div>
                    <div class="card-body">
                        <h6 class="card-title">Ask on GitHub Discussions</h6>
                        <p class="card-text">
                            We're building a community forum where you can ask questions, share experiences, and help other DICE users.
                        </p>

                            <small>
                                <strong>Why use the forum?</strong>
                                <ul class="mb-0 mt-2">
                                    <li>Your question and answer help other researchers</li>
                                    <li>Searchable archive of solutions</li>
                                    <li>Faster responses from the community</li>
                                    <li>We can track and prioritize common issues</li>
                                </ul>
                            </small>

                        <p class="text-muted small my-3">
                            <i class="bi bi-info-circle"></i>
                            Requires a free GitHub account (recommended for DICE users anyway).
                        </p>

                        <a href="https://github.com/Howquez/DICE/discussions" target="_blank" class="btn btn-primary">
                            <i class="bi bi-github"></i> Go to Discussions Forum
                        </a>
                    </div>
                </div>

                <!-- Secondary: Email -->
                <div class="card border-secondary">
                    <div class="card-body">
                        <h6 class="card-title">
                            <i class="bi bi-envelope"></i> Email
                        </h6>
                        <p class="card-text text-muted">
                            For private or sensitive matters, you can contact us directly via email: hauke.roggenkamp [at] unisg.ch
                        </p>
                    </div>
                </div>

            </div>
        </div>
    </div>
</div>

<!-- Feed Preview Offcanvas -->
<div class="offcanvas offcanvas-start" tabindex="-1" id="feedPreviewOffcanvas" aria-labelledby="feedPreviewOffcanvasLabel">
    <div class="offcanvas-header">
        <h5 class="offcanvas-title" id="feedPreviewOffcanvasLabel">Feed Preview</h5>
        <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
    </div>
    <div class="offcanvas-body p-0">
        <div id="offcanvasPreviewContent"></div>
    </div>
</div>

</body>
</html>